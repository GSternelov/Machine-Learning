---
title: "Introduction to Machine Learning - Lab 8"
author: "Gustav Sternel√∂v"
date: "Thursday, December 03, 2015"
output:
  pdf_document:
    fig_height: 3.5
    fig_width: 6
---

# Assignment 1

## 1.1

## 1.2
Data is divided into a train and a test data set. The train set consists of 70 % of the original data set and the test set of the remaining 30 %.
```{r, echo=FALSE}
Spambase <- read.csv2("C:/Users/Gustav/Documents/Machine-Learning/Lab 8/spambaseshort.csv", sep=";")
n=dim(Spambase)[1]
set.seed(12345)
id=sample(1:n, floor(n*0.7))
train=Spambase[id,]
test=Spambase[-id,]
```

## 1.3

## 1.4

## 1.5

## 1.6
```{r, echo=FALSE, warning=FALSE}
train[train==-1] <- 0
test[test==-1] <- 0

logi <- glm(Spam~.,data=train, family=binomial())
pred_logi <- data.frame(test$Spam, fitted=predict(logi, newdata=test, type="response"))
for(i in 1:length(pred_logi[,1])){
  if(pred_logi[i, 2] > 0.5){
    pred_logi[i, 2] = 1
  }else{
    pred_logi[i, 2] = 0
  }
}
confMat <- table(pred_logi)
MisClass <- 1 - sum(diag(confMat)) / sum(confMat)
```

For the variable Spam the class *-1* is changed to *0*. Then a logistic regression is fitted where Spam is the target variable. The model is fitted on train data and evaluated by predicting the class for the observations in the test set. A confusion matrix of the predicted values against the observed values is created and can be seen  below. Since 17 of the 138 observations is misclassified the obtained misclassification rate is `r round(MisClass, 3)`.

```{r, echo=FALSE}
confMat
```


# Assignment 2

## 2.1-2.2

```{r, echo=FALSE, warning=FALSE}
### Assignment 2
## 2.1
FruitFly <- read.csv2("C:/Users/Gustav/Documents/Machine-Learning/Lab 8/mortality.csv", sep=";")
FruitFlySz <- data.frame(scale(FruitFly, scale = TRUE, center=TRUE))

## 2.2
library(ggplot2)
qplot(y=LMR,x=Day, data=FruitFlySz, geom = "line", xlab="Day",ylab="LMR") 
```

## 2.3
```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(neuralnet)
set.seed(7235)
network2_3 <- neuralnet(LMR ~ Day, data = FruitFlySz, hidden = 1, act.fct =
            "tanh", stepmax = 1e6, threshold = 0.1)
```
### a)
```{r, echo=FALSE}
plot(network2_3)
```

### b)

```{r, echo=FALSE}
plot(y=FruitFlySz$LMR, x=FruitFlySz$Day, type="l", lwd=2)
points(x=FruitFlySz$Day, unlist(network2_3$net.result), col="darkorange", type="l",
       lwd=2)
```

## 2.4

### a)
```{r, echo=FALSE}
## 2.4
set.seed(7235)
network2_4 <- neuralnet(LMR ~ Day, data = FruitFlySz, hidden = 2, act.fct =
                          "tanh", stepmax = 1e6, threshold = 0.1)
# a)
plot(network2_4)
```

### b)
```{r, echo=FALSE}
# b)
plot(y=FruitFlySz$LMR, x=FruitFlySz$Day, type="l", lwd=2)
points(x=FruitFlySz$Day, unlist(network2_4$net.result), col="darkorange", type="l",
       lwd=2)
```


## 2.5

### Four hidden neurons
```{r, echo=FALSE}
## 2.5
# Four hidden neurons
set.seed(7235)
network2_5a <- neuralnet(LMR ~ Day, data = FruitFlySz, hidden = 4, act.fct =
                          "tanh", stepmax = 1e6, threshold = 0.1)
#plot(network2_5a)
plot(y=FruitFlySz$LMR, x=FruitFlySz$Day, type="l", lwd=2)
points(x=FruitFlySz$Day, unlist(network2_5a$net.result), col="darkorange", type="l",
       lwd=2)
```


### Five hidden neurons
```{r, echo=FALSE}
# Five hidden neurons
set.seed(7235)
network2_5b <- neuralnet(LMR ~ Day, data = FruitFlySz, hidden = 5, act.fct =
                           "tanh", stepmax = 1e6, threshold = 0.1)
#plot(network2_5b)
plot(y=FruitFlySz$LMR, x=FruitFlySz$Day, type="l", lwd=2)
points(x=FruitFlySz$Day, unlist(network2_5b$net.result), col="darkorange", type="l",
       lwd=2)
```

